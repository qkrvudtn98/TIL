# 2022.08.08 TIL

## ëª©ì°¨

- Reactì—ì„œ API í˜¸ì¶œí•˜ê¸°
- React ìµœì í™” : UseMemo

<hr></hr>
<br></br>

## 1ï¸âƒ£ Reactì—ì„œ API í˜¸ì¶œí•˜ê¸°

### APIë€?

#### APIì˜ ì‚¬ì „ì  ì •ì˜ëŠ” **ì‘ìš©í”„ë¡œê·¸ë¨ í”„ë¡œê·¸ë˜ë° ì¸í„°í˜ì´ìŠ¤**ì´ë‹¤. ì‘ìš©í”„ë¡œê·¸ë¨ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ê°ì¢… ì œì–´ ê¸°ëŠ¥ì„ ë‹´ì€ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” í”„ë¡œê·¸ë¨ì¸ë°, fetch í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì´ëŸ¬í•œ APIë¥¼ Reactì—ì„œ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.

#### APIëŠ” async/await í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë™ê¸°ì ìœ¼ë¡œ í˜¸ì¶œëœë‹¤. ì™œëƒí•˜ë©´ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°„ì˜ í†µì‹ ì´ê¸° ë•Œë¬¸ì—, í†µì‹ ì˜ ì„±ê³µ/ì‹¤íŒ¨ ìœ ë¬´ë¥¼ ì•Œ ìˆ˜ ì—†ìœ¼ë©° ì‹œê°„ ë˜í•œ ì–¼ë§ˆë‚˜ ê±¸ë¦´ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì´ë‹¤. ê·¸ë ‡ê¸°ì— javascriptëŠ” API í˜¸ì¶œì— ë¹„ë™ê¸° ì²˜ë¦¬ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤.

```javascript
// asyncë¥¼ ì‚¬ìš©í•˜ì—¬ getDataê°€ í”„ë¡œë¯¸ìŠ¤ ê°ì²´ì„ì„ ì„¤ì •
const getData = async () => {
    // ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ë™ê¸°ì  ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” await í‚¤ì›Œë“œ ì‚¬ìš© â†’ ì„œë²„ë¡œë¶€í„° json ê°ì²´ ë°›ì•„ì˜¤ê¸° ì„±ê³µí•˜ë©´ ë‚´ìš©ë§Œ êº¼ë‚´ì£¼ëŠ” json ë©”ì„œë“œê¹Œì§€ ì‚¬ìš©
    const res = await fetch("https://jsonplaceholder.typicode.com/comments").then(
        (res) => res.json();
    );
};
```

#### ì´ë ‡ê²Œ ì„œë²„ì—ì„œ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ ìƒí™©ì— ë§ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```javascript
const getData = async () => {
  const res = await fetch("https://jsonplaceholder.typicode.com/comments").then(
    (res) => res.json()
  );

  // JSON ê°ì²´ì˜ ì†ì„± ê°’ë“¤ ì»´í¬ë„ŒíŠ¸ì˜ ì†ì„± ê°’ë“¤ë¡œ ë°”ê¿”ì¤„ ìˆ˜ ìˆìŒ
  const initData = res.slice(0, 20).map((it) => {
    return {
      author: it.email,
      content: it.body,
      emotion: Math.floor(Math.random() * 5) + 1,
      created_date: new Date().getTime(),
      id: dataId.current++,
    };
  });

  // ìƒíƒœ ë³€ìˆ˜ JSON ë°ì´í„°ë¥¼ ì´ìš©í•´ ë°”ê¾¸ì–´ì¤€ ê²ƒìœ¼ë¡œ ì„¤ì •
  setData(initData);
};
```

<hr></hr>
<br></br>

## 2ï¸âƒ£ React ìµœì í™” : UseMemo

### âœ” Memoizationì´ë€?

#### Memoizationì´ë€ ë§ ê·¸ëŒ€ë¡œ ë©”ëª¨ë¥¼ í•´ë‘”ë‹¤ë¼ëŠ” ëœ»ì´ë‹¤. ì´ë¯¸ ê³„ì‚°í•´ë³¸ ê²°ê³¼ë¥¼ ê¸°ì–µí•´ ë‘ì—ˆë‹¤ê°€ ë˜‘ê°™ì€ ë¬¸ì œë¥¼ ë§Œë‚˜ë©´ ê¸°ì–µí•´ ë‘ì—ˆë˜ ë‹µì„ êº¼ë‚´ ì“°ê²Œ ë˜ëŠ” ê²ƒì´ë‹¤.

#### ì‚¬ëŒì˜ ê²½ìš° í•´ê²°í–ˆë˜ ë¬¸ì œì˜ ì •ë‹µì„ ì™¸ì›Œ ë‹¤ì‹œ ì“°ëŠ” ê²ƒì€ ë¹„íš¨ìœ¨ì ì¸ ë°©ë²•ì´ë¼ê³  ì—¬ê¸¸ ìˆ˜ ìˆë‹¤. ê·¸ ë¬¸ì œë¥¼ í’‚ìœ¼ë¡œì„œ ì–»ëŠ” ë¶€ë¶„ì´ ì•„ë¬´ê²ƒë„ ì—†ê¸° ë•Œë¬¸ì´ë‹¤. í•˜ì§€ë§Œ ì´ë¥¼ ì»´í“¨í„°ì— ì ìš©í•´ë³¸ë‹¤ë©´ ì •ë°˜ëŒ€ì˜ íŒë‹¨ì„ ë‚´ë¦´ ìˆ˜ ìˆë‹¤. ì»´í“¨í„°ëŠ” ì‚¬ëŒì— ë¹„í•´ í›¨ì”¬ ë§ì€ ì •ë³´ë“¤ì„ ì €ì¥í•˜ê³ , ê¸°ì–µí•  ìˆ˜ ìˆë‹¤. ë¬¼ë¡  í•œê³„ëŠ” ì¡´ì¬í•˜ì§€ë§Œ, ì—„ì²­ë‚˜ê²Œ ë§ì€ ì •ë³´ë“¤ì„ ê¸°ì–µí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë˜‘ê°™ì€ ë¬¸ì œë¥¼ ë‹¤ì‹œ í•´ê²°í•œë‹¤ë©´ ë‹¤ì‹œ í‘¸ëŠ”ë°ì— í•„ìš”í•œ ì—°ì‚°ì„ êµ³ì´ í•  í•„ìš”ê°€ ì—†ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ ì»´í“¨í„°ì˜ ì…ì¥ì—ì„œ ë°”ë¼ë³¸ë‹¤ë©´, Memoizationì„ ì´ìš©í•˜ì—¬ ì—°ì‚° ê³¼ì •ì„ ìµœì í™”í•  ìˆ˜ ìˆë‹¤.

### 1. êµ¬ë¬¸

```javascript
// ìµœì í™” í•˜ê³  ì‹¶ì€ ë¶€ë¶„
const getDiaryAnalysis = () => {
  const goodCount = data.filter((it) => it.emotion >= 3).length;
  const badCount = data.length - goodCount;
  const goodRatio = (goodCount / data.length) * 100;
  return { goodCount, badCount, goodRatio };
};

// useMemoë¥¼ ì´ìš©í•œ ìµœì í™”
// ë‘ë²ˆì§¸ ì¸ìëŠ” ë°°ì—´ í˜•íƒœë¥¼ ê°–ëŠ”ë°, useEffectì˜ dependency arrayì™€ ë˜‘ê°™ì€ ì˜ë¯¸ë¥¼ ê°–ëŠ”ë‹¤. ì¦‰, ì•„ë˜ì˜ ì˜ˆì‹œì—ì„œëŠ” data.lengthì˜ ìƒíƒœì— ë³€í™”ê°€ ìˆì–´ì•¼ ìœ„ì˜ ì½œë°±í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ëŠ” êµ¬ì¡°ì¸ ê²ƒì´ë‹¤.
// ê²°ê³¼ì ìœ¼ë¡œ dependency arrayì˜ ìƒíƒœê°€ ë³€í•˜ì§€ ì•Šìœ¼ë©´ useMemoë¥¼ ì‚¬ìš©í•œ Memoizationëœ ë¶€ë¶„ì€ ì ˆëŒ€ ë³€í•˜ì§€ ì•ŠëŠ” ìµœì í™” ìƒíƒœë¥¼ ìœ ì§€í•œë‹¤.
const getDiaryAnalysis = useMemo(() => {
  const goodCount = data.filter((it) => it.emotion >= 3).length;
  const badCount = data.length - goodCount;
  const goodRatio = (goodCount / data.length) * 100;
  return { goodCount, badCount, goodRatio };
}, [data.length]);
```

### 2. ì£¼ì˜ ì‚¬í•­

#### useMemoë¥¼ ì‚¬ìš©í•˜ë©´ ìœ„ì˜ ì˜ˆì œì™€ ê°™ì´ getDiaryAnalysisëŠ” í•¨ìˆ˜ì—ì„œ ê°’ìœ¼ë¡œ ë³€í•˜ê²Œ ëœë‹¤. ë”°ë¼ì„œ useMemoë¥¼ í†µí•´ í•¨ìˆ˜ë¥¼ ìµœì í™” í•˜ì˜€ë‹¤ë©´, ìµœì í™” í•œ ì´í›„ì—ëŠ” ê°’ìœ¼ë¡œì„œ í˜¸ì¶œì„ í•˜ì—¬ì•¼ í•œë‹¤!! (ìì£¼ ì‹¤ìˆ˜ í•˜ëŠ” ë¶€ë¶„ì´ë¼ê³  í•¨!)

<hr></hr>
<br></br>

## 3ï¸âƒ£ ì»´í¬ë„ŒíŠ¸ ì¬ì‚¬ìš© : React.memo

#### useMemoë¥¼ ì‚¬ìš©í•˜ì—¬ Memoizationì„ í•˜ëŠ” ë°©ë²•ì„ ë°”ë¡œ ì•ì—ì„œ ì†Œê°œí•˜ì˜€ë‹¤. ì´ ë°©ë²•ì€ ì—°ì‚° ê²°ê³¼ë¥¼ ì¬ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ì—ˆë‹¤. í•˜ì§€ë§Œ ë²”ìœ„ë¥¼ ë” ë„“í˜€ì„œ ì»´í¬ë„ŒíŠ¸ ìì²´ë¥¼ Memoization ì‹œì¼œì£¼ê³  ì‹¶ì„ ë•ŒëŠ” ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?

### React.memoë€?

#### ê³µì‹ë¬¸ì„œ https://ko.reactjs.org/docs/react-api.html#reactmemo ì— ë”°ë¥´ë©´ React.memoëŠ” ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ë¼ê³  ì†Œê°œí•˜ê³  ìˆë‹¤. ë¦¬ì•¡íŠ¸ì—ì„œ ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ëŠ” ê¸°ì¡´ì˜ ì»´í¬ë„ŒíŠ¸ì˜ ê¸°ëŠ¥ì„ í–¥ìƒ ì‹œì¼œì£¼ëŠ” ì—­í• ì„ í•´ì¤€ë‹¤. ì•„ë˜ì˜ ì˜ˆì‹œë¥¼ ë³´ì.

```javascript
// ê°•í™”ëœ ì»´í¬ë„ŒíŠ¸ = React.memo(ê°•í™”í•˜ê³ ì í•˜ëŠ” ì»´í¬ë„ŒíŠ¸)ì˜ êµ¬ë¬¸ì„ ê°–ê²Œ ë˜ëŠ” ê²ƒì´ë‹¤.
const EnhancedComponent = higherOrderComponent(WrappedComponent);
```

#### ì´ êµ¬ë¬¸ì„ ê³§ë°”ë¡œ React.memoì— ì ìš©ì‹œì¼œë³¸ êµ¬ë¬¸ì„ ê³µì‹ë¬¸ì„œì—ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ ì†Œê°œí•˜ê³  ìˆë‹¤.

```javascript
const MyComponent = React.memo(function MyComponent(props) {
  /* propsë¥¼ ì‚¬ìš©í•˜ì—¬ ë Œë”ë§ */
});
```

#### ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ì¸ React.memoë¥¼ í™œìš©í•˜ë©´ ì»´í¬ë„ŒíŠ¸ ìê¸° ìì‹ ì˜ ì„±ëŠ¥ì„ í–¥ìƒ ì‹œí‚¬ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

#### ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì— ì˜í•´ í•œêº¼ë²ˆì— ëœë”ë§ì´ ë˜ëŠ” ìƒí™©ì´ ìˆë‹¤ê³  ê°€ì •í•´ë³´ì. ìì‹Aì˜ ìƒíƒœ ë³€í™”ì— ì˜í•´ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ ì „ì²´ê°€ ë¦¬ëœë”ë§ ëœë‹¤ë©´, ìì‹BëŠ” ë³€í™”ê°€ ì—†ìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ë¦¬ëœë”ë§ë˜ëŠ” ìì›ë‚­ë¹„ê°€ ìƒê¸¸ ê²ƒì´ë‹¤. ì´ ë•Œ, ìì‹Bë¥¼ ê³ ì°¨ì»´í¬ë„ŒíŠ¸ë¥¼ ì´ìš©í•˜ì—¬ ìê¸°ìì‹ ì´ ë°”ë€Œì§€ ì•Šê²Œ React.memoë¥¼ ì´ìš©í•˜ì—¬ ë§Œë“¤ì–´ì¤€ë‹¤ë©´, ë¬¸ì œëŠ” í•´ê²°ë  ê²ƒì´ë‹¤.

```javascript
const ChildCompomentB = React.memo(({ props }) => {
  useEffect(() => {
    console.log("re-rendering!");
  });

  return <div>{props}</div>;
});

const ParentComponent = () => {
  const [state, setState] = useState("");

  return (
    <div>
      <ChildComponentB props={props} />
    </div>
  );
};
```

#### React.memoì— ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬ë˜ëŠ” propsì˜ ê°’(=state)ì´ ë°”ë€Œì§€ ì•ŠëŠ” ì´ìƒ ë” ì´ìƒ ìì‹ì»´í¬ë„ŒíŠ¸BëŠ” ë¦¬ëœë”ë§ ë˜ì§€ ì•Šì„ ê²ƒì´ë‹¤.

#### ë˜í•œ React.memoëŠ” ì»´í¬ë„ŒíŠ¸ íŒŒì¼ì˜ ê°€ì¥ í•˜ë‹¨ì— í•„ìˆ˜ì ìœ¼ë¡œ ì‘ì„±í•´ì•¼í•˜ëŠ” export default ChildComponentBì— ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ì—¬ë„ ëœë‹¤.

```javascript
const ChildCompomentB = ({ props }) => {
  useEffect(() => {
    console.log("re-rendering!");
  });

  return <div>{props}</div>;
};

export default React.memo(ChildComponentB);
```

#### React.memoê°€ ì ìš©ëœ ì»´í¬ë„ŒíŠ¸ì¸ ChildComponentBë¥¼ ë°–ìœ¼ë¡œ ë‚´ë³´ë‚¸ë‹¤ëŠ” ì˜ë¯¸ì˜ ì½”ë“œì´ë¯€ë¡œ, ì•ì— ì–¸ê¸‰í–ˆë˜ ì½”ë“œì™€ ë˜‘ê°™ì€ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ê²Œ ë˜ëŠ” ê²ƒì´ë‹¤. ì´ì™€ ê°™ì€ ì‘ì„±ë°©ì‹ì€ React.memoë¡œ ì„¤ì •í•´ì•¼ í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì˜ ê¸¸ì´ê°€ ê¸¸ ê²½ìš° ìì£¼ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ë‹¤.

<br>
<hr>

## 4ï¸âƒ£ useCallback :

<br>
<hr>

### ğŸ“¢ ë‚˜ì¤‘ì— ì¶”ê°€ í•´ì•¼í•  ëª©ë¡ : ê°ì²´ + React.memo

```

```
